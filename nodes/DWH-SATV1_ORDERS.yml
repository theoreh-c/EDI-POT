fileVersion: 1
id: c9332815-7569-47ff-9058-938cffb7b7f0
name: SATV1_ORDERS
operation:
  config:
    postSQL: ""
    preSQL: ""
  database: ""
  deployEnabled: true
  description: Orders data as defined by TPC-H
  isMultisource: false
  locationName: DWH
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0c82b9c3-2226-4e9b-b5c3-5079c47eb04a
          stepCounter: c9332815-7569-47ff-9058-938cffb7b7f0
        config:
          is_hk: true
        dataType: STRING
        description: ""
        hashDetails: null
        name: H_ORDER_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2afa3e76-f97d-4fe9-bdf1-f41281ca7fdc
                stepCounter: 30c0b8a5-c16d-47ee-a0fc-faefa1c3b212
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9283104d-cd40-4d8a-8fc2-394a3e6d52bc
          stepCounter: c9332815-7569-47ff-9058-938cffb7b7f0
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        hashDetails: null
        name: O_ORDERKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 787012c5-a73c-4b3d-b6a2-a6fddaae0e1c
                stepCounter: 30c0b8a5-c16d-47ee-a0fc-faefa1c3b212
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 31f963fe-d06d-4cea-a719-8ff638056ee1
          stepCounter: c9332815-7569-47ff-9058-938cffb7b7f0
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        hashDetails: null
        name: O_CUSTKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5ee64046-ed5e-46ec-8b70-3d3353d902b9
                stepCounter: 30c0b8a5-c16d-47ee-a0fc-faefa1c3b212
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8376d899-fafb-406a-9d52-00cc605ccdbf
          stepCounter: c9332815-7569-47ff-9058-938cffb7b7f0
        config: {}
        dataType: VARCHAR(1)
        description: ""
        hashDetails: null
        name: O_ORDERSTATUS
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 705e30e6-8027-4aa8-9237-03291cbfa691
                stepCounter: 30c0b8a5-c16d-47ee-a0fc-faefa1c3b212
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 15f4623b-a62f-42ce-8d72-085a6b813bf4
          stepCounter: c9332815-7569-47ff-9058-938cffb7b7f0
        config: {}
        dataType: NUMBER(12,2)
        description: ""
        hashDetails: null
        name: O_TOTALPRICE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 90241cbc-ee08-47c5-aea0-cd88ab0eef26
                stepCounter: 30c0b8a5-c16d-47ee-a0fc-faefa1c3b212
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c182e027-0711-4525-9871-e98dba3d3fc0
          stepCounter: c9332815-7569-47ff-9058-938cffb7b7f0
        config: {}
        dataType: DATE
        description: ""
        hashDetails: null
        name: O_ORDERDATE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 62076f7e-5ef6-461e-8e72-dbc878ab4349
                stepCounter: 30c0b8a5-c16d-47ee-a0fc-faefa1c3b212
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4e78c30f-c53d-4972-bb85-4f910cf22c9f
          stepCounter: c9332815-7569-47ff-9058-938cffb7b7f0
        config: {}
        dataType: VARCHAR(15)
        description: ""
        hashDetails: null
        name: O_ORDERPRIORITY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e2453ad4-0b77-45b2-a25d-6b18b42164df
                stepCounter: 30c0b8a5-c16d-47ee-a0fc-faefa1c3b212
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e36031a1-9915-4851-96fc-0a5bd899402a
          stepCounter: c9332815-7569-47ff-9058-938cffb7b7f0
        config: {}
        dataType: VARCHAR(15)
        description: ""
        hashDetails: null
        name: O_CLERK
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 86c250fe-bb01-4396-90bf-cca9ada4de63
                stepCounter: 30c0b8a5-c16d-47ee-a0fc-faefa1c3b212
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e53263c6-7035-4997-a415-56846e71ee0a
          stepCounter: c9332815-7569-47ff-9058-938cffb7b7f0
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        hashDetails: null
        name: O_SHIPPRIORITY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 39241607-5382-43d0-bb56-b5e309390618
                stepCounter: 30c0b8a5-c16d-47ee-a0fc-faefa1c3b212
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2098fa5f-3272-4878-8a10-294a87056bda
          stepCounter: c9332815-7569-47ff-9058-938cffb7b7f0
        config: {}
        dataType: VARCHAR(79)
        description: ""
        hashDetails: null
        name: O_COMMENT
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8991e456-b1ef-40f4-9a2b-90c7c6a0056a
                stepCounter: 30c0b8a5-c16d-47ee-a0fc-faefa1c3b212
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ea3dd729-d8a3-47be-8437-7307e6c2aaa4
          stepCounter: c9332815-7569-47ff-9058-938cffb7b7f0
        config: {}
        dataType: TIMESTAMP
        description: The Load Date Timestamp (LDTS) describes when this data first arrived in the Data Warehouse.
        hashDetails: null
        name: LDTS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 07478a33-e551-4f69-b164-b2cd8ed5783d
                stepCounter: 30c0b8a5-c16d-47ee-a0fc-faefa1c3b212
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ad1cc4b0-ddd9-4231-abf7-d83348aa3418
          stepCounter: c9332815-7569-47ff-9058-938cffb7b7f0
        config: {}
        dataType: STRING
        description: The Record Source (RSRC) describes the source of this data.
        hashDetails: null
        name: RSRC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 48fe8b96-2b74-4c23-8bab-887d074cf304
                stepCounter: 30c0b8a5-c16d-47ee-a0fc-faefa1c3b212
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 93341c9f-f0f4-4773-9b64-35a77f913bcc
          stepCounter: c9332815-7569-47ff-9058-938cffb7b7f0
        config: {}
        dataType: STRING
        description: ""
        hashDetails: null
        name: S_ORDER_HASH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4a22976a-9cd4-4f58-a755-000ec19fae8e
                stepCounter: 30c0b8a5-c16d-47ee-a0fc-faefa1c3b212
            transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: c8a79dd9-c75b-452e-847f-610fab7accf6
          stepCounter: c9332815-7569-47ff-9058-938cffb7b7f0
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        is_system_ledts: true
        name: LEDTS
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: |-
              COALESCE(LEAD("{{ datavault4coalesce.config.ldts_alias }}" - INTERVAL '1 MICROSECOND') 
              OVER (PARTITION BY "{{ get_value_by_column_attribute("is_hk") }}" 
              ORDER BY "{{ datavault4coalesce.config.ldts_alias }}"), {{ datavault4coalesce__string_to_timestamp(datavault4coalesce.config.timestamp_format, datavault4coalesce.config.end_of_all_times) }})
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 0f51dc54-c4f1-4877-b87d-ec25a47fd21f
          stepCounter: c9332815-7569-47ff-9058-938cffb7b7f0
        config: {}
        dataType: BOOLEAN
        defaultValue: ""
        description: ""
        is_system_current_col: true
        name: IS_CURRENT
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: |-
              CASE 
                WHEN 
                  LEAD("{{ datavault4coalesce.config.ldts_alias }}" - INTERVAL '1 MICROSECOND') 
                  OVER (PARTITION BY "{{ get_value_by_column_attribute("is_hk") }}" 
                  ORDER BY "{{ datavault4coalesce.config.ldts_alias }}") IS NULL 
                THEN TRUE 
                ELSE FALSE 
              END
    cteString: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases: {}
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: DWH
            nodeName: SATV0_ORDERS
        join:
          joinCondition: FROM {{ ref('DWH', 'SATV0_ORDERS') }} "SATV0_ORDERS"
        name: SATV1_ORDERS
        noLinkRefs: []
  name: SATV1_ORDERS
  overrideSQL: false
  schema: ""
  sqlType: DV:::9
  type: sql
  version: 1
type: Node
